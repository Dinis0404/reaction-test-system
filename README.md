# åœ¨çº¿æµ‹éªŒç³»ç»Ÿ

ä¸€ä¸ªåŸºäº Next.js çš„åœ¨çº¿æµ‹éªŒç³»ç»Ÿï¼Œå¯ä»¥ä»èµ„æ–™å¤¹è¯»å–é¢˜ç›®æ–‡ä»¶ï¼Œéšæœºæ’åˆ—é¢˜ç›®å¹¶æä¾›é€‰æ‹©é¢˜ç•Œé¢è®©ç”¨æˆ·ä½œç­”ï¼Œæ˜¾ç¤ºåˆ†æ•°ä¸å›é¦ˆã€‚

## åŠŸèƒ½ç‰¹ç‚¹

- ğŸ“š ä» `/data` èµ„æ–™å¤¹è¯»å– JSON æ ¼å¼çš„é¢˜ç›®
- ğŸ² è‡ªåŠ¨éšæœºæ’åˆ—é¢˜ç›®é¡ºåº
- ğŸ’¡ ç¾è§‚çš„ç­”é¢˜ç•Œé¢
- âœ… å³æ—¶æ˜¾ç¤ºç­”é¢˜ç»“æœä¸è¯¦ç»†å›é¦ˆ
- ğŸ“Š åˆ†æ•°ç»Ÿè®¡ä¸è¿›åº¦æ˜¾ç¤º
- ğŸ¨ ä½¿ç”¨ Tailwind CSS æ„å»ºç°ä»£åŒ– UI

## å®‰è£…æ­¥éª¤

1. **å®‰è£…ä¾èµ–**
```bash
npm install
```

2. **å‡†å¤‡é¢˜åº“æ–‡ä»¶**
   å°†é¢˜ç›®æ–‡ä»¶æ”¾åœ¨ `data/` ç›®å½•ä¸‹ï¼Œæ ¼å¼ä¸º JSONã€‚ç¤ºä¾‹æ ¼å¼ï¼š

```json
[
  {
    "id": 1,
    "question": "é¢˜ç›®å†…å®¹",
    "options": ["é€‰é¡¹A", "é€‰é¡¹B", "é€‰é¡¹C", "é€‰é¡¹D"],
    "correctAnswer": 0,
    "explanation": "ç­”æ¡ˆè§£æ"
  }
]
```

3. **å¯åŠ¨å¼€å‘æœåŠ¡å™¨**
```bash
npm run dev
```

4. **è®¿é—®ç½‘ç«™**
   æ‰“å¼€æµè§ˆå™¨è®¿é—® [http://localhost:3000](http://localhost:3000)

## é¢˜åº“æ–‡ä»¶æ ¼å¼

é¢˜åº“æ–‡ä»¶å¿…é¡»ä¸º JSON æ ¼å¼ï¼Œæ”¾åœ¨ `data/` ç›®å½•ä¸‹ã€‚ç³»ç»Ÿä¼šè‡ªåŠ¨åŠ è½½è¯¥ç›®å½•ä¸‹æ‰€æœ‰ `.json` æ–‡ä»¶ã€‚

æ¯ä¸ªé¢˜ç›®å¿…é¡»åŒ…å«ä»¥ä¸‹å­—æ®µï¼š

- `id` (number): é¢˜ç›®å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œå¿…é¡» >= 0
- `question` (string): é¢˜ç›®å†…å®¹ï¼Œå¿…é¡»éç©º
- `choices` (string[]): é€‰é¡¹æ•°ç»„ï¼Œè‡³å°‘ 2 ä¸ªé€‰é¡¹ï¼Œæ¯ä¸ªé€‰é¡¹å¿…é¡»éç©º
- `answerIndex` (number): æ­£ç¡®ç­”æ¡ˆçš„ç´¢å¼•ï¼ˆ0 ä¸ºç¬¬ä¸€ä¸ªé€‰é¡¹ï¼‰ï¼Œå¿…é¡»åœ¨ choices èŒƒå›´å†…
- `explanation` (string, å¯é€‰): ç­”æ¡ˆè§£æ

**ç¤ºä¾‹ï¼š**
```json
{
  "id": 1,
  "question": "JavaScript ä¸­å“ªä¸ªæ–¹æ³•ç”¨äºå‘æ•°ç»„æœ«å°¾æ·»åŠ å…ƒç´ ï¼Ÿ",
  "choices": ["push()", "pop()", "shift()", "unshift()"],
  "answerIndex": 0,
  "explanation": "push() æ–¹æ³•ç”¨äºå‘æ•°ç»„æœ«å°¾æ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ ã€‚"
}
```

**éªŒè¯è§„åˆ™ï¼š**
- ä¸ç¬¦åˆæ ¼å¼è¦æ±‚çš„é¢˜ç›®ä¼šè¢«è·³è¿‡å¹¶è®°å½•é”™è¯¯æ—¥å¿—
- éªŒè¯é”™è¯¯ä¸ä¼šé˜»æ­¢æœ‰æ•ˆé¢˜ç›®çš„åŠ è½½

## é¡¹ç›®ç»“æ„

```
website/
â”œâ”€â”€ data/                  # é¢˜åº“èµ„æ–™å¤¹
â”‚   â””â”€â”€ questions.json     # é¢˜ç›®æ–‡ä»¶
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ api/              # API è·¯ç”±
â”‚   â”‚   â””â”€â”€ quiz/         # æµ‹éªŒ API
â”‚   â”‚       â”œâ”€â”€ new.ts                           # åˆ›å»ºæ–°æµ‹éªŒ
â”‚   â”‚       â””â”€â”€ [sessionId]/                     # Session ç›¸å…³
â”‚   â”‚           â”œâ”€â”€ answer.ts                    # æäº¤ç­”æ¡ˆ
â”‚   â”‚           â””â”€â”€ result.ts                    # è·å–ç»“æœ
â”‚   â”œâ”€â”€ _app.tsx          # Next.js App ç»„ä»¶
â”‚   â””â”€â”€ index.tsx         # é¦–é¡µ
â”œâ”€â”€ lib/                   # å·¥å…·åº“
â”‚   â”œâ”€â”€ questionValidator.ts    # é¢˜ç›®éªŒè¯
â”‚   â”œâ”€â”€ questionLoader.ts       # é¢˜åº“åŠ è½½
â”‚   â”œâ”€â”€ questionShuffler.ts     # é¢˜ç›®éšæœºåŒ–
â”‚   â””â”€â”€ sessionManager.ts       # Session ç®¡ç†
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ QuizContainer.tsx # æµ‹éªŒå®¹å™¨ç»„ä»¶
â”‚   â””â”€â”€ QuestionCard.tsx  # é¢˜ç›®å¡ç‰‡ç»„ä»¶
â”œâ”€â”€ app/
â”‚   â””â”€â”€ globals.css       # å…¨å±€æ ·å¼
â”œâ”€â”€ package.json
â”œâ”€â”€ next.config.js
â”œâ”€â”€ tailwind.config.js
â””â”€â”€ tsconfig.json
```

## API æ¥å£

### GET /api/quiz/new
åˆ›å»ºæ–°çš„æµ‹éªŒ session å¹¶è·å–éšæœºé¢˜ç›®

**æŸ¥è¯¢å‚æ•°ï¼š**
- `count` (å¯é€‰): é¢˜ç›®æ•°é‡ï¼Œé»˜è®¤ä¸º 10ï¼Œæœ€å¤§ä¸º 100
- `shuffleChoices` (å¯é€‰): æ˜¯å¦éšæœºæ‰“æ•£é€‰é¡¹ï¼Œé»˜è®¤ä¸º true

**å“åº”ï¼š**
```json
{
  "sessionId": "quiz_1234567890_abc123",
  "questions": [
    {
      "id": 1,
      "question": "é¢˜ç›®å†…å®¹",
      "choices": ["é€‰é¡¹A", "é€‰é¡¹B", "é€‰é¡¹C", "é€‰é¡¹D"]
    }
  ],
  "total": 10,
  "count": 10
}
```

### POST /api/quiz/[sessionId]/answer
æäº¤ç­”æ¡ˆï¼ˆæ”¯æŒå•é¢˜æˆ–æ‰¹é‡æäº¤ï¼‰

**è¯·æ±‚ä½“ç¤ºä¾‹ï¼ˆæ‰¹é‡ï¼‰ï¼š**
```json
{
  "answers": [
    {
      "questionId": 1,
      "selectedIndex": 0
    }
  ]
}
```

**å“åº”ï¼š**
```json
{
  "success": true,
  "message": "ç­”æ¡ˆå·²ä¿å­˜",
  "submittedCount": 1
}
```

### GET /api/quiz/[sessionId]/result
è·å–æµ‹éªŒç»“æœ

**å“åº”ï¼š**
```json
{
  "sessionId": "quiz_1234567890_abc123",
  "score": 80,
  "correctCount": 8,
  "totalQuestions": 10,
  "submitted": true,
  "submittedAt": 1234567890000,
  "results": [...]
}
```

è¯¦ç»† API æ–‡æ¡£è¯·å‚é˜… [API_DOCUMENTATION.md](./API_DOCUMENTATION.md)

## æ„å»ºç”Ÿäº§ç‰ˆæœ¬

```bash
npm run build
npm start
```

## æŠ€æœ¯æ ˆ

- **å‰ç«¯æ¡†æ¶**: Next.js 14 (React 18)
- **æ ·å¼**: Tailwind CSS
- **è¯­è¨€**: TypeScript
- **åç«¯**: Next.js API Routes
- **çŠ¶æ€ç®¡ç†**: å†…å­˜ Mapï¼ˆSession ç®¡ç†ï¼‰
- **éšæœºç®—æ³•**: Fisher-Yates æ´—ç‰Œç®—æ³•

## æ ¸å¿ƒåŠŸèƒ½

âœ… **é¢˜ç›®éªŒè¯**: è‡ªåŠ¨éªŒè¯é¢˜åº“æ ¼å¼ï¼Œè·³è¿‡æ— æ•ˆé¢˜ç›®  
âœ… **éšæœºåŒ–**: é¢˜ç›®å’Œé€‰é¡¹éƒ½ä¼šéšæœºæ‰“æ•£  
âœ… **Session ç®¡ç†**: æ”¯æŒå¤šä¸ªå¹¶å‘çš„æµ‹éªŒ session  
âœ… **ç­”æ¡ˆä¿æŠ¤**: é¢˜ç›®è¿”å›æ—¶ä¸åŒ…å«ç­”æ¡ˆä¿¡æ¯  
âœ… **è¾“å…¥éªŒè¯**: ä¸¥æ ¼çš„è¾“å…¥éªŒè¯å’Œé”™è¯¯å¤„ç†  
âœ… **æ€§èƒ½ä¼˜åŒ–**: é¢˜ç›®ç¼“å­˜æœºåˆ¶ï¼Œå‡å°‘æ–‡ä»¶è¯»å–

<<<<<<< HEAD
## æ³¨æ„äº‹é …
=======
## æ³¨æ„äº‹é¡¹
>>>>>>> 79fe0b00784f73255711c3a8084566819cf8a950

- ç¡®ä¿ `data/questions.json` æ–‡ä»¶å­˜åœ¨
- é¢˜ç›®æ–‡ä»¶å¿…é¡»æ˜¯æœ‰æ•ˆçš„ JSON æ ¼å¼
- æœåŠ¡å™¨ç«¯å£é»˜è®¤ä¸º 3000ï¼ˆå¯åœ¨ `package.json` ä¸­ä¿®æ”¹ï¼‰

## è®¸å¯è¯

MIT

<<<<<<< HEAD
## æˆç¸¾åˆ†æåŠŸèƒ½è¦åŠƒ

### ç›®æ¨™
- åœ¨ç¶²ç«™æ–°å¢ã€Œæˆç¸¾åˆ†æã€é é¢èˆ‡è³‡æ–™ç®¡é“ï¼Œå°‡æ¯æ¬¡ç·´ç¿’çš„æˆç¸¾èˆ‡è©³æƒ…ä¿å­˜ä¸¦å¯è¦–åŒ–ï¼Œæä¾›è¶¨å‹¢ã€åˆ†é¡ã€å¼±é …åˆ†æèˆ‡åŒ¯å‡ºåŠŸèƒ½ã€‚

### è³‡æ–™ä¾†æºèˆ‡ä¿å­˜
- æˆç¸¾ä¾†æºï¼š`/api/quiz/complete` å›å‚³çš„ `summary` èˆ‡ `results`ã€‚
- å‰ç«¯ä¿å­˜ï¼šä½¿ç”¨ `localStorage`ï¼ˆéµåï¼š`quiz_results`ï¼‰è¨˜éŒ„æ¯æ¬¡ç·´ç¿’çš„æ‘˜è¦èˆ‡è©³æƒ…ï¼Œé¿å…ç„¡ä¼ºæœå™¨ç’°å¢ƒå¯«æª”é™åˆ¶ã€‚
- åŒ¯å‡º/åŒ¯å…¥ï¼šæä¾› JSON åŒ¯å‡ºèˆ‡åŒ¯å…¥ï¼Œæ”¯æ´è·¨è£ç½®è½‰ç§»è³‡æ–™ã€‚

### è³‡æ–™çµæ§‹ï¼ˆå»ºè­°ï¼‰
```json
{
  "id": "result_1733020000000_abcd123",
  "sessionId": "quiz_...",
  "timestamp": 1733020000000,
  "score": 80,
  "correctCount": 8,
  "totalQuestions": 10,
  "selectedFiles": ["english/U2LP_MC.txt", "chinese/ç™»é«˜.txt"],
  "folder": "english",
  "results": [
    {
      "questionId": 1,
      "isCorrect": true,
      "correctIndex": 2,
      "selectedIndex": 2
    }
  ]
}
```

### åˆ†æç¶­åº¦
- æ•´é«”ï¼šå¹³å‡åˆ†æ•¸ã€ç¸½ä½œç­”æ¬¡æ•¸ã€è¿‘ N æ¬¡è¶¨å‹¢ã€‚
- ä¾åˆ†é¡ï¼š`english`ã€`math`ã€`chinese`ã€`other` çš„å¹³å‡åˆ†èˆ‡æ­£ç¢ºç‡ã€‚
- é¡Œå‹ï¼šé¸æ“‡é¡Œ/å¡«ç©ºé¡Œæ­£ç¢ºç‡ã€‚
- éŒ¯é¡Œ TOPï¼šéŒ¯èª¤æ¬¡æ•¸æœ€é«˜çš„é¡Œç›®èˆ‡é¸é …åˆ†ä½ˆã€‚
- æ™‚é–“ç¶­åº¦ï¼šæŒ‰æ—¥æœŸçš„åˆ†æ•¸æŠ˜ç·šåœ–ã€æ™‚æ®µç†±åº¦ï¼ˆæ—©/æ™šï¼‰ã€‚

### å‰ç«¯é é¢èˆ‡å…ƒä»¶
- æ–°é é¢ï¼š`pages/report.tsx`
  - `ReportDashboard`ï¼šç¸½è¦½æŒ‡æ¨™å¡ç‰‡ï¼ˆå¹³å‡åˆ†æ•¸ã€ç·´ç¿’æ¬¡æ•¸ã€æœ€è¿‘åˆ†æ•¸ï¼‰ã€‚
  - `TrendChart`ï¼šè¿‘ N æ¬¡åˆ†æ•¸æŠ˜ç·šï¼ˆåˆæœŸä¸å¼•å…¥åœ–è¡¨åº«ï¼Œä½¿ç”¨åŸç”Ÿ SVG/ç°¡å–®æ¢å½¢ï¼‰ã€‚
  - `CategoryBreakdown`ï¼šåˆ†é¡æ­£ç¢ºç‡æ¢å½¢åœ–ã€‚
  - `WrongQuestionList`ï¼šéŒ¯é¡Œæ¸…å–®èˆ‡é »ç‡ã€‚
  - `ExportImportControls`ï¼šJSON åŒ¯å‡º/åŒ¯å…¥ã€‚
- å°èˆªï¼šåœ¨é¦–é æˆ–çµæœé åŠ å…¥ã€ŒæŸ¥çœ‹æˆç¸¾åˆ†æã€æŒ‰éˆ•ï¼Œè·³è½‰è‡³ `/report`ã€‚

### é‚è¼¯èˆ‡å‡½å¼åº«
- æ–°å¢å·¥å…·ï¼š`lib/analytics.ts`
  - `saveResult(summary, results, context)`ï¼šä¿å­˜ä¸€æ¬¡ç·´ç¿’çš„ç´€éŒ„è‡³ `localStorage`ã€‚
  - `getAllResults()`ï¼šè®€å–å…¨éƒ¨ç´€éŒ„ã€‚
  - `computeOverview(results)`ï¼šè¨ˆç®—å¹³å‡åˆ†ã€æ¬¡æ•¸ã€æœ€è¿‘åˆ†æ•¸ã€‚
  - `computeByCategory(results)`ï¼šè¨ˆç®—å„åˆ†é¡æŒ‡æ¨™ã€‚
  - `computeTrend(results)`ï¼šè¿‘ N æ¬¡åˆ†æ•¸åºåˆ—ã€‚
  - `computeWrongTop(results)`ï¼šçµ±è¨ˆéŒ¯é¡Œæ’åèˆ‡é¸é …åˆ†ä½ˆã€‚
- ä»‹é¢å°æ¥ï¼šåœ¨ `QuizContainer.submitAllAnswers` æˆåŠŸå¾Œå¯«å…¥ `saveResult(...)`ã€‚

### APIï¼ˆé¸é…ï¼‰
- è‹¥éœ€ä¼ºæœå™¨ç«¯ä¿å­˜èˆ‡åŒæ­¥ï¼Œå¯å¾ŒçºŒæ“´å……ï¼š
  - `POST /api/report/ingest`ï¼šæ¥æ”¶ä¸€æ¬¡ç·´ç¿’çš„æ‘˜è¦èˆ‡è©³æƒ…ï¼ˆæ³¨æ„ç„¡ä¼ºæœå™¨ç’°å¢ƒæ–‡ä»¶å¯«å…¥é™åˆ¶ï¼‰ã€‚
  - `GET /api/report/list`ï¼šè¿”å›æ­·å²æˆç¸¾ï¼ˆåˆç‰ˆæ¡å‰ç«¯æœ¬åœ°ä¿å­˜ï¼Œä¸å¼·åˆ¶å¾Œç«¯ï¼‰ã€‚

### å¯¦ä½œæ­¥é©Ÿ
1. å»ºç«‹ `lib/analytics.ts`ï¼Œå¯¦ä½œæœ¬åœ°ä¿å­˜èˆ‡çµ±è¨ˆå‡½å¼ã€‚
2. åœ¨ `components/QuizContainer.tsx` çš„æäº¤çµæœæˆåŠŸè™•ç†ä¸­å‘¼å« `saveResult(...)`ã€‚
3. æ–°å¢ `pages/report.tsx` èˆ‡å°æ‡‰å±•ç¤ºå…ƒä»¶ã€‚
4. åœ¨çµæœé åŠ å…¥ã€ŒæŸ¥çœ‹æˆç¸¾åˆ†æã€å…¥å£ï¼›é¦–é å°è¦½å¯é¸ã€‚
5. åŠ å…¥ JSON åŒ¯å‡º/åŒ¯å…¥é‚è¼¯èˆ‡é˜²å‘†ï¼ˆè³‡æ–™ç‰ˆæœ¬æ¬„ä½ï¼‰ã€‚
6. é©—è­‰ï¼šè£½é€  3â€“5 æ¬¡ç·´ç¿’è³‡æ–™ï¼Œæª¢æŸ¥è¶¨å‹¢èˆ‡åˆ†é¡çµ±è¨ˆæ˜¯å¦æ­£ç¢ºã€‚

### å¾ŒçºŒæ“´å……
- æ¨™ç±¤èˆ‡ä¸»é¡Œï¼šç‚ºæ¯å€‹æª”æ¡ˆæˆ–é¡Œç›®æ¨™è¨˜äº‹é …ï¼ˆç« ç¯€/è¬›æ¬¡ï¼‰ï¼Œå¢åŠ ç´°ç²’åº¦åˆ†æã€‚
- é›²ç«¯åŒæ­¥ï¼šæ¥å…¥è³‡æ–™åº«ï¼ˆå¦‚ Supabaseï¼‰ä»¥æ”¯æ´è·¨è£ç½®è¨˜éŒ„èˆ‡åˆ†äº«ã€‚
- è¦–è¦ºåŒ–å¼·åŒ–ï¼šå¼•å…¥åœ–è¡¨åº«ï¼ˆå¦‚ Chart.jsã€Rechartsï¼‰æ”¹å–„åœ–è¡¨è¡¨ç¾ã€‚

### DeepSeek æ¥å…¥
- æ–°å¢ APIï¼š`POST /api/analysis/deepseek`ï¼Œå°‡ä¸€æ¬¡ç·´ç¿’çš„æ‘˜è¦èˆ‡è©³æƒ…é€è‡³ DeepSeek å–å¾—åˆ†æã€‚
- ç’°å¢ƒè®Šæ•¸ï¼šåœ¨å°ˆæ¡ˆæ ¹å»ºç«‹ `.env.local`ï¼ŒåŠ å…¥ `DEEPSEEK_API_KEY=ä½ çš„å¯†é‘°`ã€‚
- ä½¿ç”¨æ–¹å¼ï¼šå®Œæˆç·´ç¿’å¾Œåœ¨çµæœé é»æ“Šã€ŒAI åˆ†ææˆç¸¾ã€ï¼Œé¡¯ç¤ºåˆ†ææ–‡å­—ã€‚
=======
>>>>>>> 79fe0b00784f73255711c3a8084566819cf8a950
